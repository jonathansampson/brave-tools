(()=>{"use strict";async function e(e){if(e.preventDefault(),"client.json"!==e.dataTransfer?.files[0].name)return void alert("Please drop a file called 'client.json'");!function(e){if(console.log(e),!Array.isArray(e)||0===e.length)return;const n=document.getElementById("days");n.innerHTML="";const a=e.reduce(((e,t)=>{const n=t.hours.reduce(((e,t)=>Math.max(e,t.adsShown.length)),0);return Math.max(e,n)}),0);for(const o of e){const e=document.createElement("div"),d=document.createElement("h2"),r=document.createElement("div"),c=t(o);e.classList.add("day"),r.classList.add("chart"),d.innerText=`${o.date.toLocaleDateString("en-US",{weekday:"short"})} ${o.date.getDate()}`,e.append(d,r,c);for(const e of o.hours){const t=document.createElement("div");t.classList.add("hour"),t.dataset.hour=e.hour.toString(),t.dataset.ads=e.adsShown.length.toString(),t.style.height=e.adsShown.length/a*100+"%",r.appendChild(t)}n.appendChild(e)}}(function(e){const t=new Date,n=[],a=new Date(t.getFullYear(),t.getMonth(),t.getDate()-7);for(let t=0;t<8;t++){const t={date:new Date(a),hours:[]};n.push(t);for(let n=0;n<24;n++){const o=[];for(const t of e.adsShownHistory){const e=new Date(1e3*t.timestamp_in_seconds),d=t.ad_content.adType,r=t.ad_content.adAction;e.getFullYear()===a.getFullYear()&&e.getMonth()===a.getMonth()&&e.getDate()===a.getDate()&&e.getHours()===n&&o.push({time:e,type:d,action:r})}t.hours.push({hour:n,adsShown:o})}a.setDate(a.getDate()+1)}return n}(await async function(e){const t=await e.text();return JSON.parse(t)}(e.dataTransfer?.files[0])))}function t(e){const t=document.createElement("table"),n=document.createElement("thead"),a=document.createElement("tbody");t.append(n,a);const o=document.createElement("tr"),d=document.createElement("th"),r=document.createElement("th");d.innerText="Hour",r.innerText="Ads",o.append(d,r),n.appendChild(o);for(const t of e.hours){if(0===t.adsShown.length)continue;const e=document.createElement("tr"),n=document.createElement("td"),o=document.createElement("td");n.innerText=t.hour.toString(),o.innerText=t.adsShown.length.toString(),e.append(n,o),a.appendChild(e)}return t}document.addEventListener("DOMContentLoaded",(()=>{document.documentElement.addEventListener("drop",e),document.documentElement.addEventListener("dragover",(e=>e.preventDefault()))}))})();