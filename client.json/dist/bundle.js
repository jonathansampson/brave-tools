(()=>{"use strict";const e={};async function t(t){if(t.preventDefault(),"client.json"!==t.dataTransfer?.files[0].name)return void alert("Please drop a file called 'client.json'");!function(t){if(console.log(t),!Array.isArray(t)||0===t.length)return;const o=document.getElementById("days");o.innerHTML="";const a=t.reduce(((e,t)=>{const n=t.hours.reduce(((e,t)=>Math.max(e,t.adsShown.length)),0);return Math.max(e,n)}),0);for(const r of t){const t=e.day.content.cloneNode(!0),d=e.chart.content.cloneNode(!0),c=d.children[0],s=t.querySelector(".card-title"),l=t.querySelector(".card-body");s.innerText=`${r.date.toLocaleDateString("en-US",{month:"short",weekday:"short"})} ${r.date.getDate()}`;for(const t of r.hours){const n=e.hour.content.cloneNode(!0).children[0];n.dataset.hour=t.hour.toString(),n.dataset.ads=t.adsShown.length.toString(),n.style.height=t.adsShown.length/a*100+"%",c.appendChild(n)}l.append(d,n(r)),o.appendChild(t)}}(function(e){const t=new Date,n=[],o=new Date(t.getFullYear(),t.getMonth(),t.getDate()-30);for(;o<t;){const t={date:new Date(o),hours:[]};n.push(t);for(let n=0;n<24;n++){const a=[];for(const t of e.adsShownHistory){const e=new Date(1e3*t.timestamp_in_seconds),r=t.ad_content.adType,d=t.ad_content.adAction;e.getFullYear()===o.getFullYear()&&e.getMonth()===o.getMonth()&&e.getDate()===o.getDate()&&e.getHours()===n&&a.push({time:e,type:r,action:d})}t.hours.push({hour:n,adsShown:a})}o.setDate(o.getDate()+1)}return n}(await async function(e){const t=await e.text();return JSON.parse(t)}(t.dataTransfer?.files[0])))}function n(t){const n=e.table.content.cloneNode(!0).children[0];for(const e of t.hours){if(0===e.adsShown.length)continue;const t=document.createElement("tr"),o=document.createElement("td"),a=document.createElement("td");o.innerText=e.hour.toString(),a.innerText=e.adsShown.length.toString(),t.append(o,a),n.tBodies[0].appendChild(t)}return n}document.addEventListener("DOMContentLoaded",(()=>{e.day=document.getElementById("day-template"),e.chart=document.getElementById("chart-template"),e.hour=document.getElementById("hour-template"),e.table=document.getElementById("table-template"),document.documentElement.addEventListener("drop",t),document.documentElement.addEventListener("dragover",(e=>e.preventDefault()))}))})();